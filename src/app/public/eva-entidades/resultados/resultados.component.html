<section mat-dialog-title>
  <button mat-icon-button color="primary" style="margin: 0 10px 0 10px" (click)="onExportExcel()">
    <mat-icon>save</mat-icon>
  </button>
  {{ !data.customTitle ? 'Resultado Evaluación de ' + data.data.nombreEvaluado : data.customTitle }}
</section>

<section mat-dialog-content>
  <div *ngFor="let i of resultados; let id = index" class="box-res">
    <b>{{ i.key }} </b>
    <mat-divider></mat-divider>

    <div *ngFor="let r of i.rows; let rd = index" [class.mgbtn10]="rd !== i.rows.length - 1">
      <div>{{ r.aspecto_evaluar }}</div>
      <div style="font-size: 12px">
        <b>
          {{
            !r.val_cond
              ? 'NO VALIDO'
              : r.val_cond == 1
              ? 'CUMPLE'
              : r.val_cond == 2
              ? 'CUMPLE PARCIALMENTE'
              : r.val_cond == 3
              ? 'NO CUMPLE'
              : r.val_cond == 4
              ? 'NO APLICA'
              : 'NO VALIDO'
          }}
          ({{ r.calificacion }}%) </b
        ><br *ngIf="r.observacion" />
        <span *ngIf="r.observacion"><b>Observación:</b> {{ r.observacion }}</span>
        <mat-divider *ngIf="rd !== i.rows.length - 1"></mat-divider>
      </div>
    </div>
    <br />
    <b>CALIFICACIÓN: {{ calcularCalificacion(i.rows) }}%</b>
  </div>

  <b>CALIFICACIÓN GENERAL: {{ calcularCalificacionGlobal() }}%</b>
</section>
